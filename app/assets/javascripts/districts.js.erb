(function () {
  'use strict';

  $(function () {
    invokeDistrictSelectBox();
  });
})();

var districtSelectProcessFn = function (data) {
  return {
    results: _.map(data, function (district) {
      return {
        id: district.id,
        text: district.name + ' (' + district.location_city + ', ' + district.location_state + ')'
      }
    })
  };
};

var districtSelectAjaxOptions = {
  url: '/districts/search.json',
  data: function (params) {
    return {
      search: params.term
    };
  },

  processResults: districtSelectProcessFn
};

var districtSelectOptions = {
  width: '100%',
  allowClear: true,
  multiple: true,
  minimumInputLength: 1,
  placeholder: '<%= I18n.t('devise.registrations.forms._profile.please_select_district') %>',
  ajax: districtSelectAjaxOptions
};

var invokeDistrictSelectBox = function () {
  $('#user_district_ids').select2(districtSelectOptions);
};
