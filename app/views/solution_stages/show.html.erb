<%= render partial: 'challenges/header', cache: true %>

<div id="solution_stage-carousel" class="carousel slide" data-ride="carousel">
  <ol class="carousel-indicators">
    <% @solution_stories.first(3).each_with_index do |solution_story, index| %>
      <li data-target="#solution_stage-carousel" data-slide-to="<%= index %>" class="<%= index.zero? ? 'active' : '' %>"></li>
    <% end %>
  </ol>
  
  <div class="carousel-inner" role="listbox">
    <% @solution_stories.first(3).each_with_index do |solution_story, index| %>
      <div class='item <%= index.zero? ? 'active' : '' %>'>
        <div class='opacity-layer'>
          <%= image_tag(solution_story.image.url, style: 'width: 100%; max-height: 400px') %>
        </div>
        <div class="carousel-caption">
          <p class='caption-title'><%= link_to solution_story.title, challenge_solution_stage_solution_story_path(@challenge, solution_story.solution_stage, solution_story), style: 'color: white' %></h2>
          <p class='caption-description'><%= solution_story.description.truncate(300) %></p>
        </div>
      </div>
    <% end %>
  </div>

  <a class="left carousel-control" href="#solution_stage-carousel" role="button" data-slide="prev">
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#solution_stage-carousel" role="button" data-slide="next">
    <span class="sr-only">Next</span>
  </a>
</div>

<div id="solution_stage-content" ng-controller="SolutionStageCtrl">
  <div class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">

        <p class='section-title'>How people are meeting the challenge</p>

        <div class='row row-count'>
          <div class='col-xs-6 col-xs-offset-3'>
            <div class='solution-header' style='margin-bottom:10px'>
              <i class='fa fa-puzzle-piece fa-3x'></i><br>
              <span><%= pluralize(@solution_stories.count, 'story') %></span>
            </div>
          </div>
        </div>

        <div class='row' style='margin-bottom: 50px'>
          <% @solution_stories.each do |solution_story| %>
            <%= render file: 'solution_stories/card', locals: { solution_story: solution_story } %>
          <% end %>
        </div>

        <p class="section-title-share">Know people who have something to add to this conversation?</p>

        <div class="row">
          <div class='col-sm-10 col-sm-offset-1'>
            <p class='section-description'>More people means more problems solved. Share this challenge!</p>
          </div>
        </div>

        <%= render partial: 'layouts/share_links', locals: { url: challenge_solution_stage_url(@challenge, @solution_stage), title: @challenge.title.html_safe, description: @challenge.description.html_safe, hashtag: @challenge.hashtag } %>

      </div>
    </div>
  </div>
</div>